<!DOCTYPE html>
<html lang="en">

<head>

    <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta charset="utf-8">
    <title>Hoffmann fanmade coffee calculator</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

    <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/custom.css">

    <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="icon" type="image/png" href="images/chemex_style.svg">

</head>

<body>
    <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <header class="u-full-width">
        <div class="header-text">
            <h1>Hoffmann fanmade coffee calculator</h1>
            <h3>Quickly calculate brew rations for delicious coffee based on James Hoffmann's recipes</h1>
        </div>
    </header>
    <div class="container">
        <div class="row" style="margin-top: 5%;">
            <div class="ten columns">
                <p>This is just a small recreation of the <a
                        href="https://coda.io/@alessandro-mingione/hoffmann-coffee-calculator">Hoffmann coffee
                        Calculator from Alessandro Mingione</a>. In this version you can set any liquid size and I fixed
                    an error with the amount of water used in the iced coffee calculation. Feel free to contribute and
                    fix errors on github.</p>
            </div>
        </div>
        <div class="row">
            <div class="nine columns">
                <div class="row">
                    <h3 id="IcedCoffee">Iced filter coffe</h3>
                    <iframe width="100%" height="315" src="https://www.youtube-nocookie.com/embed/PApBycDrPo0"
                        title="YouTube video player" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen></iframe>

                    <form>
                        <div class="row">
                            <div class="one-half column">
                                <label for="targetLiquid" >Liquid Size</label>
                                <input type="number" name="targetLiquid" value="500" oninput="calculateIcedCoffe(this)"> ml
                                <label for="groundCoffee">Ground coffee</label>
                                <input type="number" name="groundCoffee" value="32.5" oninput="calculateIcedCoffe(this)" step="0.1"> g
                                <label for="icePercentInput">% of ice</label>

                                <div class="row u-full-width"> <input type="range"  name="icePercentInput" value="40" oninput="calculateIcedCoffe(this)"> <output name="amountIcePercent">40</output>

                                    <label for="amountIce">Ice</label><output name="amountIce">200</output> g
                                    <label for="amountWater">Water (to boil)</label><output name="amountWater">300</output> ml
                                    <label for="amountBloom">Water for bloom</label><output name="amountBloom">65</output> ml
                                </div>
                            </div>
                            <div class="one-half column">
                                <h4>Breakdown</h4>
                                <b>Before: </b> Prepare decanter with <output name="amountIce2">200</output> g of ice,
                                rinse paper filter
                                under sink. <br>
                                <code>0:00</code> Bloom with <output name="amountBloom2">65</output> ml, wait 45s. <br>
                                <code>0:45</code> Pour <output name="pour1">115</output> ml in 30s. <b>Total: <output
                                        name="pour1total">180</output> g</b> <br>
                                <code>1:15</code> Pour <output name="pour2">120</output> ml in 30s. <b>Total: <output
                                        name="pour2total">300</output> g</b> <br>
                                <code>1:45</code> Stir 1x clockwise and 1x counterclockwise, swirl, and let it draw
                                down. <br>
                                <b>After: </b> Swirl brew in decanter to melt all the ice. Pour onto fresh ice cubes in
                                glass.
                            </div>
                        </div>

                    </form>
                </div>
                <div class="row">
                    <h3 id="V60">Ultimate V60 (and Chemex)</h3>
                    <iframe width="100%" height="315"
                        src="https://www.youtube-nocookie.com/embed/AI4ynXzkSQo?controls=0" title="YouTube video player"
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen></iframe>

                    <form>
                        <div class="row">
                            <div class="one-half column">
                                <label for="targetLiquid">Liquid Size</label>
                                <input type="number" name="targetLiquid" value="500" oninput="calculateV60(this)"> ml
                                <label for="groundCoffee">Ground coffee</label>
                                <input type="number" name="groundCoffee" value="30" oninput="calculateV60(this)" step="0.1"> g
                                <label for="amountWater">Water (to boil)</label><output name="amountWater">500</output> ml
                                
                                <label for="amountBloom">Water for bloom</label><output name="amountBloom">60</output> ml
                            </div>
                            <div class="one-half column">
                                <h4>Breakdown</h4>
                                <b>Before: </b> rinse paper filter with hot water. <br>
                                <code>0:00</code> Bloom with <output name="amountBloom2">60</output> ml, wait 45s. <br>
                                <code>0:45</code> Pour <output name="pour1">240</output> ml in 30s. <b>Total: <output
                                        name="pour1total">300</output> g</b> <br>
                                <code>1:15</code> Pour <output name="pour2">200</output> ml in 30s. <b>Total: <output
                                        name="pour2total">500</output> g</b> <br>
                                <code>1:45</code> Stir 1x clockwise and 1x counterclockwise, swirl, and let it draw
                                down. <br>
                            </div>
                        </div>

                    </form>
                </div>
                <div class="row">
                    <h3 id="French">Ultimate french press</h3>
                    <iframe width="100%" height="315"
                        src="https://www.youtube-nocookie.com/embed/st571DYYTR8?controls=0" title="YouTube video player"
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen></iframe>

                    <form >
                        <div class="row">
                            <div class="one-half column">
                                <label for="targetLiquid">Liquid Size</label>
                                <input type="number" name="targetLiquid" value="500" oninput="calculateFrenchPress(this)"> ml
                                <label for="groundCoffee">Ground coffee</label>
                                <input type="number"name="groundCoffee" value="30" oninput="calculateFrenchPress(this)" step="0.1"> g
                                <label for="amountWater">Water (to boil)</label><output name="amountWater">500</output> ml
                            </div>
                            <div class="one-half column">
                                <h4>Breakdown</h4>
                                <code>0:00</code> Combine coffee and water, let sit for 4 minutes. <br>
                                <code>4:00</code> Grab two spoons, <b>stir</b> the crust on the top, stuff will begin to
                                fall down, <b>scoop</b> away everything that's left floating on top. <b>Do nothing for
                                    5+ minutes</b>(recommended activities: read the newspaper, make breakfast, start a
                                rebellion).<br>
                                <code>12:00ish</code> Put the plunger right on the surface of the coffee, pour coffee in
                                the cup. <br>
                            </div>
                        </div>

                    </form>
                </div>
            </div>
            <div class="three columns">
                <div id="navbar">
                    <a href="#IcedCoffee">Iced Coffee</a>
                    <a href="#V60">Ultimate V60 (and Chemex)</a>
                    <a href="#French">Ultimate french press</a></div>

            </div>
        </div>
    </div>

    <script type="text/javascript">
        function calculateFrenchPress(element) {

            let form = getFormElementSetGroundCoffe(element);
            let coffePerLiter = 60;


            let amountLiquid = parseFloat(form.targetLiquid.value);
            calculateGroundCoffee(form, amountLiquid, coffePerLiter);
            setWaterToBoil(form, amountLiquid);

        }

        function calculateV60(element) {
            let coffePerLiter = 60;
            let form = getFormElementSetGroundCoffe(element);
            
            let amountLiquid = parseFloat(form.targetLiquid.value);

            calculateGroundCoffee(form, amountLiquid, coffePerLiter);
            calculateBloom(form, amountLiquid, coffePerLiter);
            calculatePour(form, amountLiquid);
            setWaterToBoil(form, amountLiquid);
        }

        function calculateIcedCoffe(element) {
            let coffePerLiter = 65;
            let form = getFormElementSetGroundCoffe(element, coffePerLiter);
  

            let icePercent = parseFloat(form.icePercentInput.value);
            let goalLiquid = parseFloat(form.targetLiquid.value);
            let amountLiquid = ((1 - icePercent / 100) * goalLiquid);
            calculateGroundCoffee(form, goalLiquid, coffePerLiter);
            calculateBloom(form, goalLiquid, coffePerLiter);
            calculatePour(form, amountLiquid);
            setWaterToBoil(form, amountLiquid);

            form.amountIcePercent.value = icePercent;
            form.amountIce.value = ((icePercent / 100) * goalLiquid).toFixed(1);
            form.amountIce2.value = ((icePercent / 100) * goalLiquid).toFixed(1);
        }

        function calculateLiquidSize(element, groundCoffee, coffePerLiter = 60) {
            let  targetLiquid = groundCoffee * 1000 / coffePerLiter;
            element.targetLiquid.value = targetLiquid.toFixed(1);
        }
        function calculateGroundCoffee(element, amountLiquid, coffePerLiter = 60) {
            let ground = (amountLiquid / 1000 * coffePerLiter);
            element.groundCoffee.value = ground.toFixed(1);
        }

        function calculateBloom(element, amountLiquid, coffePerLiter = 60) {
            let blooming = (amountLiquid / 500 * coffePerLiter);
            element.amountBloom.value = blooming.toFixed(1);
            element.amountBloom2.value = blooming.toFixed(1);
        }

        function calculatePour(element, amountLiquid) {
            let blooming = parseFloat(element.amountBloom.value);
            let pour1total = amountLiquid * 0.6;
            let pour1 = pour1total - blooming;

            element.pour1total.value = pour1total.toFixed(1);
            element.pour1.value = pour1.toFixed(1);
            element.pour2total.value = (amountLiquid).toFixed(1);
            element.pour2.value = (amountLiquid - pour1total).toFixed(1);
        }

        function setWaterToBoil(element, amountLiquid) {
            element.amountWater.value = amountLiquid.toFixed(1);
        }

        function getFormElementSetGroundCoffe(element, coffePerLiter=60){
            let form = element.closest("form");
            if(element.name == "groundCoffee"){
                calculateLiquidSize(form, parseFloat(element.value), coffePerLiter);
            }
            return form;
        }


    </script>
    <!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>

</html>